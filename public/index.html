<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monitor de Preços | Space Tenis</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/recharts/umd/Recharts.js"></script>
  <link rel="stylesheet" href="/public/styles.css">
</head>
<body class="min-h-screen bg-slate-950 text-slate-50">
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,#4f46e5_0,#111827_25%),radial-gradient(circle_at_80%_0%,#0ea5e9_0,#111827_22%),radial-gradient(circle_at_50%_80%,#22d3ee_0,#0f172a_28%)] opacity-40 pointer-events-none"></div>
  <div class="relative max-w-7xl mx-auto px-6 py-8 lg:px-10 lg:py-10 space-y-10">
    <header class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6 bg-slate-900/70 border border-slate-800 rounded-3xl shadow-2xl shadow-sky-500/10 backdrop-blur p-6">
      <div class="flex items-center gap-4">
        <div class="mark">ST</div>
        <div>
          <h1 class="text-2xl font-semibold">Space Tênis — Pricing Ops</h1>
          <small class="text-slate-400">Monitoramento diário e comparativos inteligentes</small>
        </div>
      </div>
      <div class="flex flex-wrap items-center gap-3">
        <div class="menu-pill" id="menuBadgeAlertas">
          <span class="dot" id="menuBadgeDot"></span>
          Alertas
          <span class="badge secondary" id="menuBadgeCount">0</span>
        </div>
        <button id="importarBtn" class="btn-primary">Importar produtos</button>
        <button class="btn-secondary" id="coletarBtn">Coletar agora</button>
      </div>
    </header>

    <main class="space-y-10">
      <section id="alertas" class="space-y-5">
        <div class="section-title">
          <div>
            <h2>Alertas internos</h2>
            <small>Receba avisos sempre que um concorrente baixar preço relevante</small>
          </div>
          <div class="pill warning" id="badgeAlertas">0 não lidos</div>
        </div>
        <div class="grid alerts-grid">
          <div class="card">
            <div class="card-title-row">
              <div>
                <h3>Configurar alertas por produto</h3>
                <small>Defina um limite percentual para ser avisado</small>
              </div>
              <span class="pill ghost" title="Dispara quando preço do concorrente ficar abaixo de (1 - limite%) do seu preço.">?</span>
            </div>
            <div class="form-grid">
              <select id="produtoAlertaSelect"></select>
              <div class="input-inline">
                <input type="number" id="thresholdInput" min="1" max="90" step="1" placeholder="Ex: 12" />
                <span class="suffix">% abaixo do meu preço</span>
              </div>
              <button id="salvarAlertaConfig" class="btn-primary">Salvar configuração</button>
            </div>
          </div>
          <div class="card">
            <div class="card-title-row">
              <div>
                <h3>Notificações internas</h3>
                <small>Alertas disparados após coletas diárias</small>
              </div>
              <span class="pill ghost" id="alertasTooltip">Histórico completo</span>
            </div>
            <div class="alert-list" id="listaAlertas"></div>
          </div>
        </div>
      </section>

      <section class="space-y-5">
        <div class="section-title">
          <h2>Dashboard analítico</h2>
          <small>Diferença percentual diária entre você e os concorrentes</small>
        </div>

        <div class="filters" id="filtrosAnaliticos">
          <div class="filter-group">
            <label for="produtoFiltro">Produto</label>
            <select id="produtoFiltro"></select>
          </div>
          <div class="filter-group">
            <label for="concorrenteFiltro">Concorrente</label>
            <select id="concorrenteFiltro"></select>
          </div>
          <div class="filter-group">
            <label for="periodoFiltro">Período</label>
            <select id="periodoFiltro">
              <option value="7">Últimos 7 dias</option>
              <option value="30" selected>Últimos 30 dias</option>
              <option value="90">Últimos 90 dias</option>
            </select>
          </div>
        </div>

        <div class="grid" id="analyticsCards"></div>

        <div class="card table-wrapper">
          <div class="table-header">
            <div>
              <h3>Comparativo de preços</h3>
              <small>Resumo automático do posicionamento</small>
            </div>
          </div>
          <table class="table" id="tabelaComparativa">
            <thead>
              <tr>
                <th>Meu preço</th>
                <th>Menor concorrente</th>
                <th>Maior concorrente</th>
                <th>Média</th>
                <th>Diferença %</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="card chart-card" id="chartWrapper">
          <div class="chart-header">
            <div>
              <h3>Histórico de preços</h3>
              <small>Linha do tempo com variações diárias</small>
            </div>
            <span class="pill ghost" id="produtoEmFoco">—</span>
          </div>
          <div id="chartRoot" class="chart-area"></div>
        </div>
      </section>

      <div class="grid" id="metricCards"></div>

      <section class="space-y-5">
        <div class="section-title">
          <h2>Gestão de fontes de concorrência</h2>
          <small>Cadastre, edite e remova lojas monitoradas</small>
        </div>
        <div class="card">
          <div class="table-header">
            <div>
              <h3>Fontes cadastradas</h3>
              <small>URLs base usadas para scraping diário</small>
            </div>
          </div>
          <table class="table" id="tabelaConcorrentes">
            <thead>
              <tr>
                <th>Nome</th>
                <th>URL base</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-title-row">
            <div>
              <h3>Adicionar/editar concorrente</h3>
              <small>Informe nome e URL base (https://...)</small>
            </div>
            <span class="pill ghost">CRUD completo</span>
          </div>
          <div class="form-grid">
            <input type="text" id="nomeConcorrente" placeholder="Nome do concorrente" />
            <input type="url" id="urlConcorrente" placeholder="URL base (https://...)" />
            <button id="salvarConcorrente" class="btn-primary">Adicionar fonte</button>
          </div>
        </div>
      </section>

      <section class="space-y-5">
        <div class="section-title">
          <h2>URLs por produto</h2>
          <small>Associe o link exato do concorrente a cada SKU</small>
        </div>
        <div class="card">
          <div class="form-grid">
            <select id="produtoAssociacao"></select>
            <select id="concorrenteAssociacao"></select>
            <input type="url" id="urlAssociacao" placeholder="URL do produto no concorrente" />
            <button id="salvarAssociacao" class="btn-primary">Vincular URL</button>
          </div>
          <div class="table-wrapper">
            <table class="table" id="tabelaAssociacoes">
              <thead>
                <tr>
                  <th>Produto</th>
                  <th>Concorrente</th>
                  <th>URL do produto</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="space-y-5">
        <div class="section-title">
          <h2>Preços coletados recentemente</h2>
          <small>Histórico armazenado para acompanhar movimentos do mercado</small>
        </div>
        <div class="card table-wrapper">
          <table class="table" id="tabelaPrecos">
            <thead>
              <tr>
                <th>Produto</th>
                <th>Concorrente</th>
                <th>Preço</th>
                <th>Coletado em</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="space-y-5">
        <div class="section-title">
          <h2>Séries históricas por produto</h2>
          <small>Visualize flutuação e posicionamento</small>
        </div>
        <div class="chart-row" id="historico"></div>
      </section>
    </main>
  </div>

  <script src="/public/script.js" type="module"></script"></script>
</body>
</html>
